2026-01-15 09:42:53 - app.services.anomaly_detector.classic - INFO - [__init__:32] - Initialized ClassicAnomalyDetector with strategy: statistical
2026-01-15 09:42:53 - app.services.workflow - INFO - [__init__:30] - Initialized InfraWorkflow with config: {'detector_type': 'classic', 'threshold': 3.0}
2026-01-15 09:42:53 - app.services.workflow - INFO - [process:180] - Processing 1 input records
2026-01-15 09:42:53 - app.services.workflow - INFO - [_validate_and_parse:35] - Validating 1 input records
2026-01-15 09:42:53 - app.services.workflow - INFO - [_validate_and_parse:39] - Successfully validated and parsed 1 records
2026-01-15 09:42:53 - app.services.workflow - INFO - [_detect_anomalies_and_extract:48] - Starting anomaly detection
2026-01-15 09:42:53 - app.services.anomaly_detector.classic - INFO - [detect:161] - Starting anomaly detection with strategy: statistical
2026-01-15 09:42:53 - app.services.anomaly_detector.classic - INFO - [detect:188] - Detection complete: 0 anomalies found
2026-01-15 09:42:53 - app.services.workflow - INFO - [_detect_anomalies_and_extract:53] - Detected 0 anomalies
2026-01-15 09:42:53 - app.services.workflow - INFO - [_final_report:121] - Generating final report
2026-01-15 09:42:53 - app.services.workflow - INFO - [_final_report:143] - Final report generated successfully
2026-01-15 09:42:53 - app.services.anomaly_detector.classic - INFO - [__init__:32] - Initialized ClassicAnomalyDetector with strategy: statistical
2026-01-15 09:42:53 - app.services.workflow - INFO - [__init__:30] - Initialized InfraWorkflow with config: {'detector_type': 'classic', 'threshold': 10.0}
2026-01-15 09:42:53 - app.services.workflow - INFO - [process:180] - Processing 1 input records
2026-01-15 09:42:53 - app.services.workflow - INFO - [_validate_and_parse:35] - Validating 1 input records
2026-01-15 09:42:53 - app.services.workflow - INFO - [_validate_and_parse:39] - Successfully validated and parsed 1 records
2026-01-15 09:42:53 - app.services.workflow - INFO - [_detect_anomalies_and_extract:48] - Starting anomaly detection
2026-01-15 09:42:53 - app.services.anomaly_detector.classic - INFO - [detect:161] - Starting anomaly detection with strategy: statistical
2026-01-15 09:42:53 - app.services.anomaly_detector.classic - INFO - [detect:188] - Detection complete: 0 anomalies found
2026-01-15 09:42:53 - app.services.workflow - INFO - [_detect_anomalies_and_extract:53] - Detected 0 anomalies
2026-01-15 09:42:53 - app.services.workflow - INFO - [_final_report:121] - Generating final report
2026-01-15 09:42:53 - app.services.workflow - INFO - [_final_report:143] - Final report generated successfully
2026-01-15 09:43:19 - app.services.anomaly_detector.classic - INFO - [__init__:32] - Initialized ClassicAnomalyDetector with strategy: statistical
2026-01-15 09:43:19 - app.services.workflow - INFO - [__init__:30] - Initialized InfraWorkflow with config: {'detector_type': 'classic', 'threshold': 3.0}
2026-01-15 09:43:19 - app.services.workflow - INFO - [process:180] - Processing 11 input records
2026-01-15 09:43:19 - app.services.workflow - INFO - [_validate_and_parse:35] - Validating 11 input records
2026-01-15 09:43:19 - app.services.workflow - INFO - [_validate_and_parse:39] - Successfully validated and parsed 11 records
2026-01-15 09:43:19 - app.services.workflow - INFO - [_detect_anomalies_and_extract:48] - Starting anomaly detection
2026-01-15 09:43:19 - app.services.anomaly_detector.classic - INFO - [detect:161] - Starting anomaly detection with strategy: statistical
2026-01-15 09:43:19 - app.services.anomaly_detector.classic - INFO - [detect:188] - Detection complete: 3 anomalies found
2026-01-15 09:43:19 - app.services.workflow - INFO - [_detect_anomalies_and_extract:53] - Detected 3 anomalies
2026-01-15 09:43:19 - app.services.workflow - INFO - [_generate_recommendations:62] - Generating recommendations
2026-01-15 09:43:19 - app.services.workflow - INFO - [_generate_recommendations:70] - Generated 2 recommendations
2026-01-15 09:43:19 - app.services.workflow - INFO - [_plan_remediation:79] - Planning remediation actions
2026-01-15 09:43:19 - app.services.workflow - INFO - [_plan_remediation:97] - Planned 2 remediation actions
2026-01-15 09:43:19 - app.services.workflow - INFO - [_human_approval_stub:106] - Processing human approval stub
2026-01-15 09:43:19 - app.services.workflow - INFO - [_human_approval_stub:112] - Marked 2 actions as pending approval
2026-01-15 09:43:19 - app.services.workflow - INFO - [_final_report:121] - Generating final report
2026-01-15 09:43:19 - app.services.workflow - INFO - [_final_report:143] - Final report generated successfully
2026-01-15 09:43:19 - app.services.anomaly_detector.classic - INFO - [__init__:32] - Initialized ClassicAnomalyDetector with strategy: statistical
2026-01-15 09:43:19 - app.services.workflow - INFO - [__init__:30] - Initialized InfraWorkflow with config: {'detector_type': 'classic', 'threshold': 10.0}
2026-01-15 09:43:19 - app.services.workflow - INFO - [process:180] - Processing 1 input records
2026-01-15 09:43:19 - app.services.workflow - INFO - [_validate_and_parse:35] - Validating 1 input records
2026-01-15 09:43:19 - app.services.workflow - INFO - [_validate_and_parse:39] - Successfully validated and parsed 1 records
2026-01-15 09:43:19 - app.services.workflow - INFO - [_detect_anomalies_and_extract:48] - Starting anomaly detection
2026-01-15 09:43:19 - app.services.anomaly_detector.classic - INFO - [detect:161] - Starting anomaly detection with strategy: statistical
2026-01-15 09:43:19 - app.services.anomaly_detector.classic - INFO - [detect:188] - Detection complete: 0 anomalies found
2026-01-15 09:43:19 - app.services.workflow - INFO - [_detect_anomalies_and_extract:53] - Detected 0 anomalies
2026-01-15 09:43:19 - app.services.workflow - INFO - [_final_report:121] - Generating final report
2026-01-15 09:43:19 - app.services.workflow - INFO - [_final_report:143] - Final report generated successfully
2026-01-15 09:44:02 - app.services.anomaly_detector.classic - INFO - [__init__:32] - Initialized ClassicAnomalyDetector with strategy: statistical
2026-01-15 09:44:02 - app.services.llm.llm - INFO - [__init__:23] - Initialized OpenAIClient with model: openrouter/mistralai/devstral-2512:free
2026-01-15 09:44:02 - app.services.workflow - INFO - [__init__:30] - Initialized InfraWorkflow with config: {'detector_type': 'classic', 'threshold': 4.0}
2026-01-15 09:44:02 - __main__ - INFO - [batch_mode:45] - Starting batch mode with input: rapport.json
2026-01-15 09:44:02 - __main__ - INFO - [batch_mode:53] - Loaded 500 records from rapport.json
2026-01-15 09:44:02 - app.services.workflow - INFO - [process:180] - Processing 500 input records
2026-01-15 09:44:02 - app.services.workflow - INFO - [_validate_and_parse:35] - Validating 500 input records
2026-01-15 09:44:02 - app.services.workflow - INFO - [_validate_and_parse:39] - Successfully validated and parsed 500 records
2026-01-15 09:44:02 - app.services.workflow - INFO - [_detect_anomalies_and_extract:48] - Starting anomaly detection
2026-01-15 09:44:02 - app.services.anomaly_detector.classic - INFO - [detect:161] - Starting anomaly detection with strategy: statistical
2026-01-15 09:44:02 - app.services.anomaly_detector.classic - INFO - [detect:188] - Detection complete: 8 anomalies found
2026-01-15 09:44:02 - app.services.workflow - INFO - [_detect_anomalies_and_extract:53] - Detected 8 anomalies
2026-01-15 09:44:02 - app.services.workflow - INFO - [_generate_recommendations:62] - Generating recommendations
2026-01-15 09:44:02 - app.services.llm.llm - INFO - [generate_recommendations:28] - Generating recommendations for 8 anomalies
2026-01-15 09:44:06 - app.services.workflow - ERROR - [_generate_recommendations:73] - Recommendation generation error: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_backends/sync.py", line 207, in connect_tcp
    with map_exceptions(exc_map):
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 982, in request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 282, in retry_sync
    raise e
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 193, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1014, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 188, in retry_sync
    for attempt in max_retries:
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7fda9ba32900 state=finished raised APIConnectionError>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 63, in _generate_recommendations
    recommendations = self.llm_client.generate_recommendations(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/llm/llm.py", line 31, in generate_recommendations
    recommendations = self.client.create(
                      ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/client.py", line 376, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/patch.py", line 258, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 285, in retry_sync
    raise InstructorRetryException(
instructor.core.exceptions.InstructorRetryException: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
2026-01-15 09:44:06 - __main__ - ERROR - [batch_mode:69] - Error in batch mode: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_backends/sync.py", line 207, in connect_tcp
    with map_exceptions(exc_map):
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 982, in request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 282, in retry_sync
    raise e
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 193, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1014, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 188, in retry_sync
    for attempt in max_retries:
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7fda9ba32900 state=finished raised APIConnectionError>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/main.py", line 55, in batch_mode
    report = workflow.process(data)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 182, in process
    result = self.graph.invoke(state)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3071, in invoke
    for chunk in self.stream(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2646, in stream
    for _ in runner.tick(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 63, in _generate_recommendations
    recommendations = self.llm_client.generate_recommendations(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/llm/llm.py", line 31, in generate_recommendations
    recommendations = self.client.create(
                      ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/client.py", line 376, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/patch.py", line 258, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 285, in retry_sync
    raise InstructorRetryException(
instructor.core.exceptions.InstructorRetryException: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
During task with name 'generate_recommendations' and id '964f9217-7689-1618-a94f-5b09369df2f7'
2026-01-15 09:44:06 - __main__ - CRITICAL - [main:39] - Fatal error in main: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_backends/sync.py", line 207, in connect_tcp
    with map_exceptions(exc_map):
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 982, in request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 282, in retry_sync
    raise e
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 193, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1014, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 188, in retry_sync
    for attempt in max_retries:
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7fda9ba32900 state=finished raised APIConnectionError>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/main.py", line 34, in main
    batch_mode(workflow, args.input)
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/main.py", line 55, in batch_mode
    report = workflow.process(data)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 182, in process
    result = self.graph.invoke(state)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3071, in invoke
    for chunk in self.stream(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2646, in stream
    for _ in runner.tick(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 63, in _generate_recommendations
    recommendations = self.llm_client.generate_recommendations(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/llm/llm.py", line 31, in generate_recommendations
    recommendations = self.client.create(
                      ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/client.py", line 376, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/patch.py", line 258, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 285, in retry_sync
    raise InstructorRetryException(
instructor.core.exceptions.InstructorRetryException: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
During task with name 'generate_recommendations' and id '964f9217-7689-1618-a94f-5b09369df2f7'
2026-01-15 09:44:19 - app.services.anomaly_detector.classic - INFO - [__init__:32] - Initialized ClassicAnomalyDetector with strategy: statistical
2026-01-15 09:44:19 - app.services.llm.llm - INFO - [__init__:23] - Initialized OpenAIClient with model: openrouter/mistralai/devstral-2512:free
2026-01-15 09:44:19 - app.services.workflow - INFO - [__init__:30] - Initialized InfraWorkflow with config: {'detector_type': 'classic', 'threshold': 4.0}
2026-01-15 09:44:19 - __main__ - INFO - [batch_mode:45] - Starting batch mode with input: rapport.json
2026-01-15 09:44:19 - __main__ - INFO - [batch_mode:53] - Loaded 500 records from rapport.json
2026-01-15 09:44:19 - app.services.workflow - INFO - [process:180] - Processing 500 input records
2026-01-15 09:44:19 - app.services.workflow - INFO - [_validate_and_parse:35] - Validating 500 input records
2026-01-15 09:44:19 - app.services.workflow - INFO - [_validate_and_parse:39] - Successfully validated and parsed 500 records
2026-01-15 09:44:19 - app.services.workflow - INFO - [_detect_anomalies_and_extract:48] - Starting anomaly detection
2026-01-15 09:44:19 - app.services.anomaly_detector.classic - INFO - [detect:161] - Starting anomaly detection with strategy: statistical
2026-01-15 09:44:19 - app.services.anomaly_detector.classic - INFO - [detect:188] - Detection complete: 8 anomalies found
2026-01-15 09:44:19 - app.services.workflow - INFO - [_detect_anomalies_and_extract:53] - Detected 8 anomalies
2026-01-15 09:44:19 - app.services.workflow - INFO - [_generate_recommendations:62] - Generating recommendations
2026-01-15 09:44:19 - app.services.llm.llm - INFO - [generate_recommendations:28] - Generating recommendations for 8 anomalies
2026-01-15 09:44:23 - app.services.workflow - ERROR - [_generate_recommendations:73] - Recommendation generation error: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_backends/sync.py", line 207, in connect_tcp
    with map_exceptions(exc_map):
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 982, in request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 282, in retry_sync
    raise e
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 193, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1014, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 188, in retry_sync
    for attempt in max_retries:
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7f92e5a65400 state=finished raised APIConnectionError>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 63, in _generate_recommendations
    recommendations = self.llm_client.generate_recommendations(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/llm/llm.py", line 31, in generate_recommendations
    recommendations = self.client.create(
                      ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/client.py", line 376, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/patch.py", line 258, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 285, in retry_sync
    raise InstructorRetryException(
instructor.core.exceptions.InstructorRetryException: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
2026-01-15 09:44:23 - __main__ - ERROR - [batch_mode:69] - Error in batch mode: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_backends/sync.py", line 207, in connect_tcp
    with map_exceptions(exc_map):
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 982, in request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 282, in retry_sync
    raise e
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 193, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1014, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 188, in retry_sync
    for attempt in max_retries:
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7f92e5a65400 state=finished raised APIConnectionError>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/main.py", line 55, in batch_mode
    report = workflow.process(data)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 182, in process
    result = self.graph.invoke(state)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3071, in invoke
    for chunk in self.stream(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2646, in stream
    for _ in runner.tick(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 63, in _generate_recommendations
    recommendations = self.llm_client.generate_recommendations(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/llm/llm.py", line 31, in generate_recommendations
    recommendations = self.client.create(
                      ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/client.py", line 376, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/patch.py", line 258, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 285, in retry_sync
    raise InstructorRetryException(
instructor.core.exceptions.InstructorRetryException: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
During task with name 'generate_recommendations' and id '16d8f9be-5721-9749-5f6a-5c13e3094bcb'
2026-01-15 09:44:23 - __main__ - CRITICAL - [main:39] - Fatal error in main: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_sync/connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_backends/sync.py", line 207, in connect_tcp
    with map_exceptions(exc_map):
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 982, in request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/runner/.local/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno -5] No address associated with hostname

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 282, in retry_sync
    raise e
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 193, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/openai/_base_client.py", line 1014, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 188, in retry_sync
    for attempt in max_retries:
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7f92e5a65400 state=finished raised APIConnectionError>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/main.py", line 34, in main
    batch_mode(workflow, args.input)
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/main.py", line 55, in batch_mode
    report = workflow.process(data)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 182, in process
    result = self.graph.invoke(state)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3071, in invoke
    for chunk in self.stream(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2646, in stream
    for _ in runner.tick(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/workflow.py", line 63, in _generate_recommendations
    recommendations = self.llm_client.generate_recommendations(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/infrastructure-anomaly-detection/infrastructure-anomaly-detection/app/services/llm/llm.py", line 31, in generate_recommendations
    recommendations = self.client.create(
                      ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/client.py", line 376, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/patch.py", line 258, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/home/runner/.local/lib/python3.12/site-packages/instructor/core/retry.py", line 285, in retry_sync
    raise InstructorRetryException(
instructor.core.exceptions.InstructorRetryException: <failed_attempts>

<generation number="1">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="2">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

<generation number="3">
<exception>
    Connection error.
</exception>
<completion>
    None
</completion>
</generation>

</failed_attempts>

<last_exception>
    Connection error.
</last_exception>
During task with name 'generate_recommendations' and id '16d8f9be-5721-9749-5f6a-5c13e3094bcb'
2026-01-15 09:44:43 - app.services.anomaly_detector.classic - INFO - [__init__:32] - Initialized ClassicAnomalyDetector with strategy: statistical
2026-01-15 09:44:43 - app.services.llm.llm - INFO - [__init__:23] - Initialized OpenAIClient with model: openrouter/mistralai/devstral-2512:free
2026-01-15 09:44:43 - app.services.workflow - INFO - [__init__:30] - Initialized InfraWorkflow with config: {'detector_type': 'classic', 'threshold': 4.0}
2026-01-15 09:44:43 - __main__ - INFO - [batch_mode:45] - Starting batch mode with input: /tmp/test_no_anomalies.json
2026-01-15 09:44:43 - __main__ - INFO - [batch_mode:53] - Loaded 1 records from /tmp/test_no_anomalies.json
2026-01-15 09:44:43 - app.services.workflow - INFO - [process:180] - Processing 1 input records
2026-01-15 09:44:43 - app.services.workflow - INFO - [_validate_and_parse:35] - Validating 1 input records
2026-01-15 09:44:43 - app.services.workflow - INFO - [_validate_and_parse:39] - Successfully validated and parsed 1 records
2026-01-15 09:44:43 - app.services.workflow - INFO - [_detect_anomalies_and_extract:48] - Starting anomaly detection
2026-01-15 09:44:43 - app.services.anomaly_detector.classic - INFO - [detect:161] - Starting anomaly detection with strategy: statistical
2026-01-15 09:44:43 - app.services.anomaly_detector.classic - INFO - [detect:188] - Detection complete: 0 anomalies found
2026-01-15 09:44:43 - app.services.workflow - INFO - [_detect_anomalies_and_extract:53] - Detected 0 anomalies
2026-01-15 09:44:43 - app.services.workflow - INFO - [_final_report:121] - Generating final report
2026-01-15 09:44:43 - app.services.workflow - INFO - [_final_report:143] - Final report generated successfully
2026-01-15 09:44:43 - __main__ - INFO - [batch_mode:60] - Batch processing completed successfully
